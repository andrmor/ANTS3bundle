// compute detection efficiency using the calorimeters' data

var dir = "/home/andr/WORK/FastNeutron_Cylinder/Out"
var fileName = dir + "/Calorimeters.json"

root.SetOptStat( "rmeoui" )

psim.loadCalorimeterData(fileName)
var num = psim.countCalorimeters()

var data = psim.getCalorimeterOverEventData(0)

var DE = core.arraySum(data)

for (var iCa = 1; iCa < num; iCa++)
{
   var ar = psim.getCalorimeterOverEventData(iCa)
   if (data.length != ar.length) core.abort("Data corrupted: mismatching colorimeter array data")
   DE += core.arraySum(ar)
   for (var i = 0; i < data.length; i++)
      data[i][1] += ar[i][1]
}

hist.new1D("h", 190, 0.1, 2)
hist.fillArr("h", data)
hist.draw("h")

var numEvents = config.getKeyValue("ParticleSim.Events")
core.print("DE:", 100.0*DE/numEvents, "%")
